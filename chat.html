<input id="message">
<button onclick="sendMessage()">Send</button>
<div id="chatBox"></div>

<script type="module">
import { db, auth } from "./firebase.js";
import { collection, addDoc, onSnapshot }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const chatId = "globalChat";

window.sendMessage = async () => {
  await addDoc(collection(db, "chats", chatId, "messages"), {
    sender: auth.currentUser.uid,
    text: message.value,
    createdAt: Date.now()
  });
};

onSnapshot(collection(db, "chats", chatId, "messages"), snapshot => {
  chatBox.innerHTML = "";
  snapshot.forEach(doc => {
    chatBox.innerHTML += `<p>${doc.data().text}</p>`;
  });
});
</script>
